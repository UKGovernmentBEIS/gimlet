server {
    listen 80;
    server_name localhost;

    # Allow large request bodies for load testing
    client_max_body_size 100M;

    location / {
        root /usr/share/nginx/html;
        autoindex on;

        # Disable buffering to ensure data flows through immediately
        proxy_buffering off;
        sendfile on;
        tcp_nopush on;
        tcp_nodelay on;
    }

    # Rate-limited large file for sustained load observation
    location = /50mb.bin {
        root /usr/share/nginx/html;

        # Limit bandwidth to 1MB/s per connection
        # This makes 50MB file take ~50s for sustained load patterns
        limit_rate 1m;

        sendfile on;
        tcp_nopush on;
        tcp_nodelay on;
    }

    # Accept POSTs but return simple response
    location /upload {
        client_max_body_size 100M;
        return 200 "Upload received\n";
    }
}
